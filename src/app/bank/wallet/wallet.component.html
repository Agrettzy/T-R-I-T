<section class="min-h-screen bg-gradient-to-b from-neutral via-black/80 to-black">
    <nav class="navbar bg-neutral/50 backdrop-blur-md shadow-md px-4 lg:px-12 border-b border-primary/20">
        <div class="flex-1">
            <a class="btn btn-ghost text-xl font-black tracking-tighter text-primary">
                T.R.I.T
            </a>
        </div>

        <div class="flex-none">
            <ul class="menu menu-horizontal px-1 font-bold gap-2 text-gray-200">
                <li class="hidden sm:block">
                    <span class="text-xs opacity-70 mr-2">
                        socio: {{ autServices.user()?.fullName }}
                    </span>
                    <a routerLink="/bank/profile" class="hover:text-primary">
                        Perfil
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="max-w-4xl mx-auto p-6 space-y-10">

        <!--  -->
        @if (walletServices.balanceResource.isLoading()) {
            <div class="flex justify-center p-20">
                <span class="loading loading-orbit loading-lg text-primary"></span>
            </div>
        }
        <!--  -->
        @else {

        <div
            class="stats shadow-2xl bg-gradient-to-b via-black/50 to-neutral/80 w-full border border-white/10 backdrop-blur-md">
            <div class="stat">
                <div class="stat-title text-gray-400">
                    Saldo Disponible
                </div>
                <div class="stat-value text-primary text-5xl font-mono">
                    ₿ {{ walletServices.balance() }}
                </div>

                <div class="stat-actions mt-4 flex gap-2">
                    <button routerLink="/bank/transfer"
                        class="btn btn-sm btn-ghost border border-white/10 hover:bg-primary hover:text-black">
                        Transferir
                    </button>
                </div>
            </div>

            <div class="stat hidden md:grid">
                <div class="stat-title text-gray-400">
                    No. Cuenta
                </div>
                <div class="stat-value text-sky-300 text-2xl font-mono bg-black/40 px-3 py-1 rounded-lg shadow-md">
                    {{ walletServices.accountKey() }}
                </div>
            </div>
        </div>

        <section class="card bg-neutral/80 backdrop-blur-md shadow-xl border border-white/10">
            <div class="card-body p-0">
                <div class="flex justify-between items-center p-6 pb-2 border-b border-white/10">
                    <h2 class="card-title font-bold text-lg uppercase tracking-wider text-white">
                        Últimos Movimientos
                    </h2>
                    <a routerLink="/bank/history" class="btn btn-ghost btn-xs text-primary">
                        Ver todos
                    </a>
                </div>

                <div class="overflow-x-auto">
                    <table class="table table-zebra w-full">
                        <thead class="bg-neutral/70 text-gray-200">
                            <tr>
                                <th>Concepto</th>
                                <th>Estado</th>
                                <th class="text-right">Monto</th>
                            </tr>
                        </thead>
                        <tbody>
                            @for (tx of walletServices.historyResource.value(); track tx.id) {
                            <tr class="hover">
                                <td>
                                    <div class="flex items-center gap-3">
                                        <div class="avatar placeholder">
                                            <div [class]="tx.type === 'received' ? 'bg-success/20 text-success' : 'bg-error/20 text-error'"
                                                class="rounded-full w-8 h-8 flex items-center justify-center font-bold">
                                                <span>
                                                    {{ tx.type === 'received' ? '↓' : '↑' }}
                                                </span>
                                            </div>
                                        </div>
                                        <div>
                                          <div class="font-bold text-primary/80">
                                                {{ tx.type === 'sent' ? 'Enviado a ' + tx.toName : 'Recibido de ' + tx.fromName }}
                                            </div>
                                            <div class="text-xs opacity-50">
                                                {{ tx.createdAt }}
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <span [class]="tx.status === 'completed' ? 'badge-success' : 'badge-warning'"
                                        class="badge badge-sm">
                                        {{ tx.status }}
                                    </span>
                                </td>
                                <td [class]="tx.type === 'received' ? 'text-success' : 'text-error'"
                                    class="text-right font-bold">
                                    {{ tx.type === 'received' ? '+' : '-' }} ₿ {{ tx.amount }}
                                </td>
                            </tr>
                            } @empty {
                            <tr>
                                <td colspan="3" class="text-center py-10 opacity-30 italic">
                                    No hay transacciones detectadas
                                </td>
                            </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
        }
    </div>
</section>
